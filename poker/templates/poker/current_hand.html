<!DOCTYPE html>
{% load static from staticfiles %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/current_hand.css' %}">
    <title>Document</title>
</head>
<body>



<div class="container">
    <div class="row">
        <div class="col heading">
            <h3>{{ table.name }}</h3>
        </div>
    </div>

{% for player in players %}
{% if player.user == request.user %}
<form method="POST" action="{% url 'leave_table' table.id player.id %}">
    {% csrf_token %}
    <input type="submit" value="Leave Table"/>
</form>

{% endif %}
<br>
{% endfor %}
<hr>
<div class="row">
{% for player in players %}

    <div class="col-sm-6 col-md-4 col-lg-3">
        
        <div class="row">
            <div class="col-12">
                <p>{{ player.user }} - <i>${{ player.chips }}</i></p>
            </div>
        
        {% if player.is_active == False %}
        <div class="row">
            <div class="col-12">
                <p>Folded</p>
            </div>
        </div>
        {% endif %}
        
        {% if player.user == request.user and player.is_active %}
        
        <div class="row">
            <div class="col-12">
        <img src="/static/images/{{ player.card_1 }}.png" width="50" height="100">
        <img src="/static/images/{{ player.card_2 }}.png" width="50" height="100">
            </div>
        {% else %}
        <div class="row">
            <div class="col-12">
        <img src="/static/images/blue_back.png" width="50" height="100">
        <img src="/static/images/blue_back.png" width="50" height="100">
            </div>
        </div>
        {% endif %}


{% if hand != None and player.user == request.user and player.is_active and player.seat_num == hand.current_player and hand.check_no < no_of_river_players %}
<div class="row">
    <div class="col-12 inline">
        
<form method="POST" action="{% url 'fold' hand.id player.id %}">
    {% csrf_token %}
    <input class="fold_btn" type="submit" value="Fold"/>
</form>
{% if hand.current_bet == 0 %} 

<form method="POST" action="{% url 'check' table.id hand.id player.id %}">
    {% csrf_token %}
    <input class="check_btn" type="submit" value="Check"/>
</form>
    </div>
</div>
{% else %}
<form method="POST" action="{% url 'call' table.id hand.id player.id %}">
    {% csrf_token %}
    <input class="call_btn" type="submit" value="Call"/>
</form>
    </div>
</div>
{% endif %}

<br>

{% if hand.current_bet == 0 %}
<div class="row">
    <div class="col">
<form method="POST" action="{% url 'bet' table.id hand.id player.id %}">
    {% csrf_token %}
    <input class="bet_btn" type="submit" value="Bet"/>
    <input class="input" type="number" step="{{ table.blinds }}" name="bet"/>
</form>
{% else %}
<form method="POST" action="{% url 'raise' table.id hand.id player.id %}">
    {% csrf_token %}
    <input class="raise_btn" type="submit" value="Raise"/>
    <input class="input" type="number" step="{{ table.blinds }}" name="raise"/>
</form>
<br>
   </div>
</div>
{% endif %}
 
{% endif %}
<br>
</div>

{% endfor %}

</div>
<hr>
<div class="row">
    <div class="col">
{% if hand.check_no >= no_of_preflop_players  %}
    <img src="/static/images/{{ hand.card_1 }}.png" width="50" height="100">
    <img src="/static/images/{{ hand.card_2 }}.png" width="50" height="100">
    <img src="/static/images/{{ hand.card_3 }}.png" width="50" height="100">
{% endif %}

{% if hand.check_no >= no_of_flop_players %}
    <img src="/static/images/{{ hand.card_4 }}.png" width="50" height="100">
{% endif %}

{% if hand.check_no >= no_of_turn_players %}
    <img src="/static/images/{{ hand.card_5 }}.png" width="50" height="100">
{% endif %}
    </div>
</div>
<hr>
<div class="row">
    <div class="col">
<h5>Winner: 
{% for winner in hand.winner.all %}
{% if hand.check_no == no_of_river_players %}
{{ winner }}
{% endif %}
{% endfor %}
</h5>

<h4>Current Player: <i>{{ hand.current_player }}</i></h4>

<h4>Raise Amount: <i>{{ hand.raise_amount }}</i></h4>

<h3>Current Bet: <i>{{ hand.current_bet }}</i></h3>

<h3>Pot: <i>{{ hand.pot }}</i></h3>
<hr>
</div>
</div>


{% if hand == None or hand.check_no == no_of_river_players %}
<form method="POST" action="{% url 'deal' table.id %}">
    {% csrf_token %}
    <input type="submit" value="Deal"/>
</form>
{% endif %}
   
</div>

